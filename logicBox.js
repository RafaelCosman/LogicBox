// Generated by CoffeeScript 1.6.3
(function(){"This is the Logic Box game by Rafael Cosman";var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_={}.hasOwnProperty,D=function(e,t){function r(){this.constructor=e}for(var n in t)_.call(t,n)&&(e[n]=t[n]);r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};e=function(){function e(e,t,n){this.loc=e;this.radius=t;this.fillColor=n}e.prototype.mouseIsOver=function(){return E().dist(this.getLoc())<this.getRadius()};e.prototype.getLoc=function(){return this.loc};e.prototype.getRadius=function(){return this.radius};e.prototype.show=function(){var e;this.mouseIsOver()?e=this.getRadius()*1.1:e=this.getRadius();pushMatrix();translate(1,1);fill(0,0,0,50);strokeWeight(0);w(e);popMatrix();fill(this.fillColor);return w(e)};return e}();o=function(){function t(){this.circle=new e(new PVector(1500,100),100,color(0,100,0))}t.prototype.run=function(){};t.prototype.show=function(){stroke(0);this.circle.show();fill(100);return text("Run all tests",0,0)};t.prototype.clicked=function(){var e,t,n,r,i;if(this.circle.mouseIsOver()){r=d.gameObjects;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];e instanceof f?i.push(e.runTest()):i.push(void 0)}return i}};t.prototype.unclicked=function(){};t.prototype.getLoc=function(){return this.circle.getLoc()};return t}();r=function(){function t(){this.dragging=!1;this.rotating=!1;this.indeces=new PVector(-1,random(0,9));this.circle=new e(p(this.indeces),S/2-2*c);this.rotationCircle=new e(p(this.indeces),S/2-2*c+20);this.rotation=0;this.offset=new PVector}t.prototype.run=function(){if(this.dragging){this.circle.loc.set(PVector.add(E(),this.offset));this.rotationCircle.loc.set(PVector.add(E(),this.offset))}if(this.rotating)return this.rotation=this.mouseAngle()+this.rotationOffset};t.prototype.clicked=function(){if(this.circle.mouseIsOver()){this.dragging=!0;return this.offset.set(PVector.sub(this.getLoc(),E()))}if(this.rotationCircle.mouseIsOver()){this.rotating=!0;return this.rotationOffset=this.mouseAngle()-this.rotation}};t.prototype.unclicked=function(){this.dragging=!1;this.rotating=!1;this.indeces=h(this.getLoc());this.circle.loc=p(this.indeces);return this.rotation=Math.round(this.rotation/HALF_PI)*HALF_PI};t.prototype.mouseAngle=function(){return x(PVector.sub(E(),this.getLoc()))};t.prototype.show=function(){var e,t;rotate(this.rotation);stroke(100);this.circle.show();strokeWeight(10);stroke(0,200,0);line(0,0,0,-this.circle.radius);translate(0,-this.circle.radius);e=7;t=5;return triangle(0,-5,e,t,-e,t)};t.prototype.getLoc=function(){return this.circle.getLoc()};return t}();s=function(e){function t(){M=t.__super__.constructor.apply(this,arguments);return M}D(t,e);t.prototype.processString=function(e){return e};return t}(r);t=function(e){function t(){t.__super__.constructor.apply(this,arguments);this.circle.fillColor=color(0,0,255)}D(t,e);t.prototype.processString=function(e){return e+=e[0]};return t}(s);n=function(e){function t(){t.__super__.constructor.apply(this,arguments);this.circle.fillColor=color(255,0,0)}D(t,e);t.prototype.processString=function(e){return e.substring(1)};return t}(s);u=function(e){function t(){t.__super__.constructor.apply(this,arguments);this.circle.fillColor=color(0)}D(t,e);return t}(s);a=function(){function e(e,t,n){this.string=e;this.loc=t;this.unitTest=n;this.indices=h(this.loc);this.vel=new PVector(0,0);this.run()}e.prototype.run=function(){var e;this.loc.add(this.vel);T(this.loc)||(this.string===this.unitTest.output?this.unitTest.passed():this.unitTest.failed());e=d.findLogicBoxByLocation(this.loc);if(e!==null){this.vel=N(e.rotation);return this.string=e.processString(this.string)}};e.prototype.show=function(){fill(200);return text(this.string,0,0)};e.prototype.clicked=function(){};e.prototype.unclicked=function(){};e.prototype.getLoc=function(){return this.loc};return e}();f=function(){function t(t,n,r){this.input=t;this.output=n;this.circle=new e(r,50,color(100))}t.prototype.run=function(){};t.prototype.show=function(){this.circle.show();stroke(200);fill(200);text(this.input,0,0);return text(this.output,0,25)};t.prototype.clicked=function(){if(this.circle.mouseIsOver())return this.runTest()};t.prototype.runTest=function(){return d.gameObjects.push(new a(this.input,d.startBox.getLoc(),this))};t.prototype.unclicked=function(){};t.prototype.passed=function(){return this.circle.fillColor=color(255)};t.prototype.failed=function(){return this.circle.fillColor=color(255,0,0)};t.prototype.getLoc=function(){return this.circle.getLoc()};return t}();i=function(e){function t(){this.gameObjects=[];this.gridWidth=6;this.startBox=new u;this.gameObjects.push(this.startBox)}D(t,e);t.prototype.findLogicBoxByLocation=function(e){var t,n,r,i;i=this.gameObjects;for(n=0,r=i.length;n<r;n++){t=i[n];if(t instanceof s&&t.getLoc().dist(e)===0)return t}return null};return t}(u);S=90;c=9;l=new PVector(S*1.5+c,S*.5+c);d=null;A=function(){textFont(createFont("FFScala",32));rectMode(CENTER);ellipseMode(CENTER);textAlign(CENTER);d=new i;d.gameObjects.push(new t);d.gameObjects.push(new n);d.gameObjects.push(new f("abc","bca",new PVector(1200,100)));d.gameObjects.push(new f("test","estt",new PVector(1300,100)));return d.gameObjects.push(new o)};v=function(){var e,t,n,r,i;background(200);fill(255);strokeWeight(2);stroke(0);rect(S*.5+c*.5,height/2,S-2*c,height-2*c);pushMatrix();m();popMatrix();r=d.gameObjects;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];e.run();pushMatrix();O(e.getLoc());e.show();i.push(popMatrix())}return i};m=function(){var e,t,n,r,i;fill(255);strokeWeight(0);stroke(255);i=[];for(e=n=0,r=d.gridWidth-1;0<=r?n<=r:n>=r;e=0<=r?++n:--n)i.push(function(){var n,r,i;i=[];for(t=n=0,r=d.gridWidth-1;0<=r?n<=r:n>=r;t=0<=r?++n:--n)i.push(L(p(new PVector(e,t)),new PVector(S,S)));return i}());return i};p=function(e){var t;t=PVector.mult(e,S+c);return PVector.add(l,t)};h=function(e){var t;t=PVector.div(PVector.sub(e,l),S+c);t.x=Math.round(t.x);t.y=Math.round(t.y);return t};x=function(e){var t;t=Math.atan(e.y/e.x);return e.x<0?t-HALF_PI:t+HALF_PI};N=function(e){e-=HALF_PI;return new PVector(cos(e),sin(e))};T=function(e){var t,n;t=new PVector(d.gridWidth,d.gridWidth);n=p(t);print(e);print(l);print(n);return e.x>=l.x&&e.y>=l.y&&e.x<=n.x&&e.y<=n.y};C=function(){var e,t,n,r,i;r=d.gameObjects;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(e.clicked())}return i};k=function(){var e,t,n,r,i;r=d.gameObjects;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(e.unclicked())}return i};E=function(){return new PVector(pcs.mouseX,pcs.mouseY)};y=function(e,t){return ellipse(e.x,e.y,t.x,t.y)};b=function(e,t){return ellipse(e.x,e.y,t*2,t*2)};g=function(e){return ellipse(0,0,e,e)};w=function(e){return ellipse(0,0,e*2,e*2)};L=function(e,t){return rect(e.x,e.y,t.x,t.y)};O=function(e){return translate(e.x,e.y)}}).call(this);